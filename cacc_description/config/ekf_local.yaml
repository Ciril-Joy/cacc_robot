ekf_filter_node_local: # Renamed from ekf_filter_node to avoid conflicts
  ros__parameters:
    frequency: 30.0 # Target update rate
    sensor_timeout: 0.1
    two_d_mode: true # True if your robot only moves in 2D plane (no roll/pitch changes)
    transform_time_offset: 0.0
    transform_timeout: 0.0
    print_diagnostics: true
    debug: false
    # publish_tf: true # Set to true if you don't have another odom source
                      # If SLAM provides map->odom, and this provides odom->base_link
                      # This should be true if no other odom->base_link source exists.

    map_frame: map      # Not used by this EKF instance directly
    odom_frame: odom    # Output frame
    base_link_frame: base_link # Your robot's base frame
    world_frame: odom   # For this local EKF, world_frame is odom

    # --- IMU ---
    imu0: /imu/data # Your IMU topic
    imu0_config: [false, false, false, # X, Y, Z
                  true,  true,  true,  # Roll, Pitch, Yaw
                  false, false, false, # dX, dY, dZ
                  true,  true,  true,  # dRoll, dPitch, dYaw
                  false, false, false] # ddX, ddY, ddZ (linear acceleration)
    imu0_differential: false
    imu0_relative: true # IMU provides orientation relative to its start or gravity
    imu0_queue_size: 10
    imu0_remove_gravitational_acceleration: true # Important if IMU provides raw accel

    # --- (Optional but Recommended) Wheel Odometry ---
    # odom0: /wheel_odom # If you have wheel odometry
    # odom0_config: [true,  true,  false, # X, Y, Z
    #                false, false, false, # Roll, Pitch, Yaw
    #                false, false, false, # dX, dY, dZ (velocities from odom)
    #                false, false, false, # dRoll, dPitch, dYaw
    #                false, false, false]
    # odom0_differential: false
    # odom0_relative: false # Odometry is usually not relative
    # odom0_queue_size: 10

    # --- Process Noise Covariance ---
    # Adjust these based on how noisy your sensors are and how much you trust them
    process_noise_covariance: [
      1.0,   0.0,   0.0,   0.0,   0.0,   0.0,   0.0,     0.0,     0.0,     0.0,     0.0,     0.0,     0.0,    0.0,    0.0,
      0.0,   1.0,   0.0,   0.0,   0.0,   0.0,   0.0,     0.0,     0.0,     0.0,     0.0,     0.0,     0.0,    0.0,    0.0,
      0.0,   0.0,   0.1,   0.0,   0.0,   0.0,   0.0,     0.0,     0.0,     0.0,     0.0,     0.0,     0.0,    0.0,    0.0,
      0.0,   0.0,   0.0,   0.03,  0.0,   0.0,   0.0,     0.0,     0.0,     0.0,     0.0,     0.0,     0.0,    0.0,    0.0,
      0.0,   0.0,   0.0,   0.0,   0.03,  0.0,   0.0,     0.0,     0.0,     0.0,     0.0,     0.0,     0.0,    0.0,    0.0,
      0.0,   0.0,   0.0,   0.0,   0.0,   0.06,  0.0,     0.0,     0.0,     0.0,     0.0,     0.0,     0.0,    0.0,    0.0,
      0.0,   0.0,   0.0,   0.0,   0.0,   0.0,   0.25,    0.0,     0.0,     0.0,     0.0,     0.0,     0.0,    0.0,    0.0,
      0.0,   0.0,   0.0,   0.0,   0.0,   0.0,   0.0,     0.25,    0.0,     0.0,     0.0,     0.0,     0.0,    0.0,    0.0,
      0.0,   0.0,   0.0,   0.0,   0.0,   0.0,   0.0,     0.0,     0.01,    0.0,     0.0,     0.0,     0.0,    0.0,    0.0,
      0.0,   0.0,   0.0,   0.0,   0.0,   0.0,   0.0,     0.0,     0.0,     0.01,    0.0,     0.0,     0.0,    0.0,    0.0,
      0.0,   0.0,   0.0,   0.0,   0.0,   0.0,   0.0,     0.0,     0.0,     0.0,     0.02,    0.0,     0.0,    0.0,    0.0,
      0.0,   0.0,   0.0,   0.0,   0.0,   0.0,   0.0,     0.0,     0.0,     0.0,     0.0,     0.01,    0.0,    0.0,    0.0,
      0.0,   0.0,   0.0,   0.0,   0.0,   0.0,   0.0,     0.0,     0.0,     0.0,     0.0,     0.0,     0.01,   0.0,    0.0,
      0.0,   0.0,   0.0,   0.0,   0.0,   0.0,   0.0,     0.0,     0.0,     0.0,     0.0,     0.0,     0.0,    0.015,  0.0,
      0.0,   0.0,   0.0,   0.0,   0.0,   0.0,   0.0,     0.0,     0.0,     0.0,     0.0,     0.0,     0.0,    0.0,    0.015]
    
    initial_estimate_covariance: [
      1.0e-9, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 1.0e-9, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 1.0e-9, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 1.0e-9, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 1.0e-9, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 1.0e-9, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
    
    